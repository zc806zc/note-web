# 开发流程

- 小程序注册 https://mp.weixin.qq.com
- 安装开发者工具 
  - https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html
  - 微信开发者工具 Beta 版  https://developers.weixin.qq.com/miniprogram/dev/devtools/beta.html
- 另外用自己的IDE

```
VS Code + minapp 插件

Sublime Text 3 + Sublime wxapp 插件
Vim + wxapp
```

# 开发

- 微信小程序接入指南

- 微信小程序设计规范

  - 产品定位

    - x: 低高频
    - y: 刚需？

- 设计原则
- 开发规则
  - 离线支持
  - 微信语言开发小程序
  - 第三方：白鹭 Egret Wing3.2
  - 有赞商城帮助商家生成小程序

- 审核规则
- 开发禁忌
    - 禁止游戏、直播、测试类
    - 禁止与微信现有功能相似服务
    - 禁止诱导分享、诱导关注、虚假欺诈内容
    - 禁止诱导、泄露、转让用户数据

# 跨端能力

```
在 iOS 上，小程序的 JavaScript 代码运行在 JavaScriptCore 中
在 Android 上，小程序的 JavaScript 代码通过 X5 内核来解析
在 开发工具上， 小程序的 JavaScript 代码运行在 NW.js（Chromium 内核） 中...
```

# 技术

- WXS

```
由于运行环境的差异，
在 iOS 设备上小程序内的 WXS 会比 JavaScript 代码快 2 ~ 20 倍。
在 Android 设备上二者运行效率无差异。
```

# 小程序机制

- wx-* 等标签
- wcc 和 wcsc 是小程序的 WXML 和 WXSS 的编译工具

![](https://user-gold-cdn.xitu.io/2018/8/13/165313e72ea7a43a?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)

# JavaScript 的限制和增强

- 浏览器环境特有的 window 对象不可用
- 跟浏览器相关的操作如 cookie、Ajax 请求（XMLHttpRequest）、DOM 选择器、DOM 事件、路由 history、缓存、设备信息、位置等都不存在

# 小程序布局

- rpx
- 让设计师按照 iPhone 6 的视觉稿标准出图即可，即宽度为 750px
- flex 布局

# 组件

- 组件

```
视图容器：主要是实现页面布局的，对常见的布局形式进行了封装，比如滚动 sroll-view 等
基本内容：类似 HTML5 中内容相关的 p、em 等
表单相关：要比 HTML5 的 form 表单丰富一些
导航：类似 a 标签
媒体：类比 HTML5 中的 video、audio 和 img 等，但是提供更标准的界面和更丰富的 API 支持
画布：Native 实现的 Canvas
地图：结合腾讯地图数据 Native 实现的组件
开放能力：这部分组件偏通用和小程序业务...
```

- 自定义组件

# 插件

- 插件开发 https://developers.weixin.qq.com/miniprogram/dev/framework/plugin/development.html

# 脚手架

- gulp > webpack
- 小程序 Gulp 开发脚手架 https://github.com/ksky521/gulp-wxapp-boilerplate

# Mock Server

- 使用 nodemon 对 server 进行自动重启

# 云开发

- 云开发 https://developers.weixin.qq.com/miniprogram/dev/wxcloud/basis/getting-started.html
- 下载开发者工具Beta

```
开发者工具会冲突!!
```

- NoSQL 数据库 + 文件存储 + 云函数

# 用户登录和授权流程

- 临时登录凭证 code
- 获取 openid 和 session_key

# 调试

- debugx5.qq.com

# 部署上线 

- 审核 ： 一般一次审核在几个小时到一天之间，第一次审核会相对慢一些
- 设置体验版本 ; 小范围公测

# 代码优化

- 循环 

```js
// 下面的操作是不推荐的
for(let i = 0; i < items.length; i++ ){
  this.setData({
    key: items[i]
  })
}
```

- 节流

```js
let timer;
$(window).scroll(() => {
  if(timer){
    clearTimeout(timer)
  }
  timer = setTimeout(() => {
    // 延时 200ms，处理滚动逻辑
  }, 200)
})
```

# 小程序优化

- 白屏时间 -> 骨架屏
- 利用逻辑层空闲时间预加载数据
- 默认数据缓存
  - https://developers.weixin.qq.com/miniprogram/dev/api/data.html
- 采用分包机制