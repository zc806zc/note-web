# 常用代码

- 右下角角标选中 <http://www.jq22.com/webqd1488>

- md5加密

  - md5
  - <http://www.jq22.com/webqd1506>

- 页脚置底 <http://liaokeyu.com/%E6%8A%80%E6%9C%AF/2017/01/06/%E8%AF%91-CSS%E4%BA%94%E7%A7%8D%E6%96%B9%E5%BC%8F%E5%AE%9E%E7%8E%B0Footer%E7%BD%AE%E5%BA%95.html>

- 锚点跳转

  - <http://www.jq22.com/webqd2418>

```javascript
$(window).ready(function() {
    $('#nav > .menu').on('click', function() {
        var $this = $(this);
        $this.addClass('active').siblings('.menu').removeClass('active');
        $("html,body").animate({
            scrollTop: $("#main > .box").eq($this.index() - 1).offset().top // 这一句
        }, 300);
        $("#bar").animate({
            left: $this.offset().left
        }, 300);
    });
});
```

- 时间工具

  - 周 <http://www.jq22.com/webqd2426>

```javascript
Date.prototype.Format = function(fmt) {
    var o = {
        "M+": this.getMonth() + 1, //月份
        "d+": this.getDate(), //日
        "h+": this.getHours() % 12 == 0 ? 12 : this.getHours() % 12, //小时
        "H+": this.getHours(), //小时
        "m+": this.getMinutes(), //分
        "s+": this.getSeconds(), //秒
        "S": this.getMilliseconds() //毫秒
    };
    //周
    var week = {
        "0": "日",
        "1": "一",
        "2": "二",
        "3": "三",
        "4": "四",
        "5": "五",
        "6": "六"
    };
    //季度
    var quarter = {
        "1": "一",
        "2": "二",
        "3": "三",
        "4": "四"
    };
    if (/(y+)/.test(fmt)) {
        fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
    }
    if (/(E+)/.test(fmt)) {
        fmt = fmt.replace(RegExp.$1, ((RegExp.$1.length > 1) ? (RegExp.$1.length > 2 ? "星期" : "周") : "") + week[this.getDay() + ""]);
    }
    if (/(q+)/.test(fmt)) {
        fmt = fmt.replace(RegExp.$1, ((RegExp.$1.length > 1) ? "第" : "") + quarter[Math.floor((this.getMonth() + 3) / 3) + ""] + "季度");
    }
    for (var j in o) {
        if (new RegExp("(" + j + ")").test(fmt)) {
            fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[j]) : (("00" + o[j]).substr(("" + o[j]).length)));
        }
    }
    return fmt;
}

$("#time1").html(new Date().Format("yyyy-MM-dd E HH:mm:ss"));
$("#time2").html(new Date().Format("yyyy-MM-dd EE hh:mm:ss"));
$("#time3").html(new Date().Format("yyyy-MM-dd EEE hh:mm:ss"));
$("#time4").html(new Date().Format("yyyy-MM-dd q h:mm:ss"));
$("#time5").html(new Date().Format("yyyy-MM-dd qq h:mm:ss"));

// 2017-11-03 五 19:52:31
// 2017-11-03 周五 07:52:31
// 2017-11-03 星期五 07:52:31
// 2017-11-03 四季度 7:52:31
// 2017-11-03 第四季度 7:52:31
```

- 全屏 <http://www.jq22.com/webqd2471>
- jQuery段实现左右div自适应相同高度

```javascript
function autoHeight() {
    if ($("left").offsetHeight >= $("right").offsetHeight) {
        $("right").style.height = $("left").offsetHeight + "px";
    } else {
        $("left").style.height = $("right").offsetHeight + "px";
    }
}
```

- 全选 | 反选
- 网页导航按钮切换

  - =变× <http://www.jq22.com/webqd2638>

```javascript
<div class="wrap">
    <span></span>

    <span></span>
</div>


.wrap {
    width:48px;
    height:30px;
    border:1px solid #ccc;
    position:relative;
}
span {
    height:2px;
    position:absolute;
    color:#484848;
    width:30px;
    margin:10px 10px;
    display:block;
    background:#484848;
    transition:.5s;
}
span:nth-child(2) {
    top:10px
}
.span1 {
    position:absolute;
    transform:rotate(-46deg);
    margin:15px  10px;
    height:2px;
    transition:.5s;
}
.span2 {
    position:absolute;
    transform:rotate(45deg);
    margin:5px 10px;
    height:2px;
    transition:.5s;
}
```

- 固定在浏览器顶部 <http://www.jq22.com/webqd2646>
- 点击空白处关闭弹窗

  - document加阻止冒泡 两个点击事件
  - <http://www.jq22.com/webqd2693>

```javascript
click("box","box");
function click(name,box) {
    $(document).on("click", function(e) {
        var _conss = $('.'+name);//点击的容器范围
        if (!_conss.is(e.target) && _conss.has(e.target).length === 0) {
            $("."+box).hide();//选择要关闭的容器
        }
    });
}
```

- 单选复选框优化 <http://www.jq22.com/webqd2718>

```html
<span class="radio_box">
 <input type="radio" id="radio_1" name="radio" checked="">
 <label for="radio_1"></label>
 <em>选项1</em>
</span>
```

- 数字滚动显示

  - <http://www.jq22.com/webqd2739>
  - <http://www.jq22.com/webqd1652>

- 导航跟随 <http://www.jq22.com/webqd1900>

```javascript
$("ul>li").hover(function() {
    var x = $(this).offset().left - 40; //计算li的位置
    console.log(x);
    $("span").css("marginLeft", x)
}, function() {
    $("span").css("marginLeft", "0")
})
```

- 导航下划线动画 <http://www.jq22.com/webqd2744>

```css
.nav1 a {
    width:70px;
    height:100%;
    float:left;
    margin:0 15px;
    position:relative;
    text-align:center;
}
.nav1 a span {
    margin:auto;
    display:inline-block;
    position:absolute;
    bottom:5px;
    left:0;
    right:0;
    width:0px;
    height:2px;
    background:#ff0000;
    transition:.5s;
    border-radius:50px;
}
.nav1 a:hover span {
    width:100%;
    left:0;
}
```

- 文本截断

  - css
  - js <http://www.jq22.com/webqd2751>

```javascript
var shortName = "我和我好朋友写代码的照片.jpg".replace(/^(^.{8})(.+)(.{2}\.+\w+$)$/g, "$1...$3");
document.getElementById('output').append(shortName);

// 多行
p {
  display:-webkit-box;
  -webkit-box-orient:vertical;
  -webkit-line-clamp:5;
  overflow:hidden;
  width:200px;
  margin:50px;
}
```

- 加入购物车

  - <http://www.jq22.com/webqd2752>
  - <http://www.jq22.com/webqd2615>

```javascript
function MoveBox(obj) {
    var divTop = $(obj).offset().top;
    var divLeft = $(obj).offset().left;
    $(obj).css({
        "position": "absolute",
        "z-index": "0",
        "left": divLeft + "px",
        "top": divTop + "px"
    });
    $(obj).parent().append($(obj).clone());
    $(obj).animate({
        "left": ($("#posBtnR").offset().left) + "px",
        "top": $("#posBtnR").offset().top + "px",
        "width": "100px",
        "height": "70px"
    }, 1000, function() {
        $(obj).animate({
            "left": $("#posBtnR").offset().left + "px",
            "top": $("#posBtnR").offset().top + "px"
        }, 1000);
        num++;
        $("#btn_num", parent.document).text(num).animate({
            'opacity': 1,
            'marginTop': '0'
        }, 500, function() {
            setTimeout(function() {
                $("#btn_num").hide()
            }, 8000);
        });
    });
}
```

- 仿淘宝页面点击元素收起或展开内容 <http://www.jq22.com/webqd2760>

```javascript
<div class="cf_allGoods">
    <div class="cf_listATitle"><i>-</i><span>查看所有商品</span></div>
    <div class="cf_agClassFi"><a>按销量</a><a>按价格</a><a>按商品</a><a>按收藏</a></div>
</div>

$(".cf_listATitle").on("click", function() {
    $(this).next().toggle(1000, function() {
        console.log($(this).prev().find("i").text());
        if ($(this).prev().find("i").text() == "-") {
            $(this).prev().find("i").text("+");
        } else {
            $(this).prev().find("i").text("-");
        }
    });
});
```

- 图片响应

  - 3D倾斜响应 <http://www.jq22.com/webqd2763>
  - 放大(传统首选)
  - 抖动 <http://www.jq22.com/webqd3242>
  - 模仿小米 图片hover的阴影效果 <http://www.jq22.com/webqd1367>

```less
// 放大
.pic-box {
    width: 200px;
    height:200px;
    overflow: hidden; // 超出隐藏

    img {
        width: 100%;
        transition: transform 1.6s; // 动画过渡

        &:hover{
          transform: scale(2.0);
        }
    }
}

// 抖动
body{
    padding:30px;
}
img:hover {
    -webkit-animation:sucaijiayuan 1s .1s ease both;
    -moz-animation:tada 1s .1s ease both;
}
@-webkit-keyframes sucaijiayuan {
    0% {
         -webkit-transform:scale(1)
  }
  10%,20% {
         -webkit-transform:scale(0.8) rotate(-2deg)
  }
   30%,50%,70%,90% {
        -webkit-transform:scale(1.1) rotate(2deg)
  }
  40%,60%,80% {
         -webkit-transform:scale(1.1) rotate(-2deg)
  }
  100% {
          -webkit-transform:scale(1) rotate(0)
  }
}
```

- 银行卡号空格 <http://www.jq22.com/webqd1489>

```javascript
$(function() {
    $('#kahao').on('keyup', function(e) {
        //只对输入数字时进行处理
        if ((e.which >= 48 && e.which <= 57) ||
            (e.which >= 96 && e.which <= 105)) {
            //获取当前光标的位置
            var caret = this.selectionStart
            //获取当前的value
            var value = this.value
            //从左边沿到坐标之间的空格数
            var sp = (value.slice(0, caret).match(/\s/g) || []).length
            //去掉所有空格
            var nospace = value.replace(/\s/g, '')
            //重新插入空格
            var curVal = this.value = nospace.replace(/(\d{4})/g, "$1 ").trim()
            //从左边沿到原坐标之间的空格数
            var curSp = (curVal.slice(0, caret).match(/\s/g) || []).length
            //修正光标位置
            this.selectionEnd = this.selectionStart = caret + curSp - sp

        }
    })
})
```

- 表格排序

  - <http://www.jq22.com/webqd2793>

- 表单

  - 文本框自动跳转下一个 <http://www.jq22.com/webqd2809>
  - <http://www.jq22.com/webqd2468>

```javascript
$(function() {
    var inputLength = $('input').length;
    //$('input').keyup(function(){})
    //使用jQuery事件代理的事件绑定方式，不需要对每个input进行事件绑定，有利于性能优化
    $('#body').delegate('input', 'keyup', function() {
        var _this = $(this),
            valLength = _this.val().length,
            index = _this.index();
        if (valLength > 0) {
            if ((index + 1) > inputLength) return false; //输入完成时进行操作
            _this.attr('data-in', 'true').next().focus();
        } else if (valLength == 0 && _this.attr('data-in') == 'true') {
            if (index == 0) return false; //删除所有时进行操作
            _this.attr('data-in', 'false').prev().focus();
        }
    });
});
```

- 三级联动

  - 省市二级联动 <http://www.jq22.com/webqd3010>
  - 字母点击选择 <http://www.jq22.com/webqd2257>

- 时钟

```javascript
window.onload = function() {
    var timer = setInterval(mytime, 1000)
}

function mytime() {
    var a = new Date();
    var b = a.getFullYear();
    var c = a.getMonth() + 1;
    var d = a.getDay();
    var e = a.getDate();
    var f = a.getHours();
    var g = a.getMinutes();
    var m = a.getSeconds();
    con.innerHTML = f + "时" + g + "分" + m + "秒";
}
```

- 抽奖

```javascript
function playFun() {
    clearInterval(timer); // 先清除
    timer = setInterval(function() {
        var random = Math.floor(Math.random() * data.length);
        title.innerHTML = data[random];
    }, 50);
}

function stopFun() {
    clearInterval(timer);
}
```

- 饿了么添加菜品小球动画 <http://www.jq22.com/webqd2892>

- 选项卡

```javascript
$("#" + wrapId).find("div").eq(index).show().siblings().hide();  // 显示自己隐藏兄弟
```

- 时间正序排序

```javascript
var data = {
    "rows": [{
        "name": "张三",
        "time": "2011-4-1 0:00:00",
    },{
        "name": "李四",
        "time": "2015-5-6 12:30:00",
    },{
        "name": "王五",
        "time": "2012-10-1 22:10:00",
    },{
        "name": "赵六",
        "time": "2011-9-1 22:10:00",
    }]
};
var rows = data.rows;
rows.sort(function(a,b){
    return Date.parse(a.time) - Date.parse(b.time);//时间正序
});
```

- 限时答题 <http://www.jq22.com/webqd3103>
- 可滚动的tbody <http://www.jq22.com/webqd3098>

```javascript
第一步是：设置 tbody 为 display:block ，以便我们可以应用 height 和 overflow 属性。
下一步将是：设置thead 中的 tr元素设置为 display:block。
```

- 去除空格

```javascript
function Trim(str) {
    var result;
    result = str.replace(/(^\s+)|(\s+$)/g, "");
    result = result.replace(/\s/g, "");
    return result;
}
```

- 关于jquery实现px转换为rem代码

```javascript
var deviceWidth = document.documentElement.clientWidth;
if (deviceWidth > 640) {
    deviceWidth = 640;
}
if (deviceWidth < 320) {
    deviceWidth = 320;
}
document.documentElement.style.fontSize = deviceWidth / 3.75 + 'px';
//此部分是设计稿宽度为375px的，这边设置为3.75  页面调用时，如果实际设计稿为760px，那边这边的3.75数值改为7.60
window.onresize = function() {
    var deviceWidth = document.documentElement.clientWidth;
    if (deviceWidth > 640) {
        deviceWidth = 640;
    }
    if (deviceWidth < 320) {
        deviceWidth = 320;
    }
    document.documentElement.style.fontSize = deviceWidth / 3.75 + 'px';
}
```

- 原生弹幕 <http://www.jq22.com/webqd3046>

- 淘宝评分

  - <http://www.jq22.com/webqd3035>
  - CSS实现 <http://www.jq22.com/webqd1144>

```javascript
function praise(num, obj) {
    obj.prevAll().attr('class', 'xx-star');
    obj.attr('class', 'xx-star');
    obj.nextAll().attr('class', 'xx-star2');
    $(".display-star").html(num + '星');
}
```

- js数字金额大写转换

  - <http://www.jq22.com/webqd3030>
  - <http://www.jq22.com/webqd1708>

- 下拉菜单 css实现 <http://www.jq22.com/webqd3033>

- 本地input选择图片实时显示

  - createObjectURL <http://www.jq22.com/webqd2884>
  - FileReader <http://www.jq22.com/webqd2885>
  - 转base64显示 <http://www.jq22.com/webqd2806>
  - 使用ie滤镜实现ie低版本图片预览功能 <http://www.jq22.com/webqd2344>
  - 带剪裁 <http://www.jq22.com/webqd1198>

```javascript
$('.a').change(function(e) {
    var _URL = window.URL || window.webkitURL;
    var file, img;
    if ((file = this.files[0])) {
        img = new Image();
        img.onload = function() {
            $('.img').attr('src', this.src);
            console.log(this.width)
        };
        img.src = _URL.createObjectURL(file);
    }
})

if (window.FileReader) {
    var reader = new FileReader();
    var _file = this.files[0];

    reader.readAsDataURL(_file);
    reader.onload = function() {
        preImg.setAttribute('src', this.result);
    }
}
```

- jQuery弹出窗口可移动、缩放 <http://www.jq22.com/webqd3029>

- 百度搜索结果 <http://www.jq22.com/webqd2961>

  - 豆瓣图书搜索功能 <http://www.jq22.com/webqd2702>

```javascript
/*
需求:
1.找到文本框，在文本框中输入的字符会出现再搜索信息框中
2.键盘事件
3.如何拿到百度关键字的数据
后台传输    AJAX    jsonp    数据渲染
*/
var oText = document.getElementById("text");
var oSea = document.getElementsByClassName("search")[0]; //class是集合，要获取下标
var oUl = oSea.getElementsByTagName("ul")[0];
oText.onkeyup = function() {
    var val = this.value;
    /*            if(val){
                    oSea.style.display = "block";
                }else{
                    oSea.style.display = "none";                
                }*/
    //三目运算
    oSea.style.display = val ? "block" : "none";
    var os = document.createElement("script");
    os.src = "https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=" + val + "&cb=xiaolong&_=1499584946110";
    document.body.appendChild(os); //当前节点中添加一个子节点
}

function xiaolong(json) {
    oUl.innerHTML = '';
    json.s.forEach(function(data) {
        var oLi = document.createElement("li");
        oLi.innerHTML = "<a href='https:www.baidu.com/s?wd=" + data + "'>" + data + "</a>";
        oUl.appendChild(oLi);
    }); //数组专门遍历
}
```

- 表单输入实时监听

```javascript
$("input").on("input propertychange", function() {
    check("user", "pass", "btn", "orange");
});
```

- 点赞 <http://www.jq22.com/webqd2408>

- 网页表格导出excel格式 <http://www.jq22.com/webqd2279>

```javascript
var daochu = (function() {
    var uri = 'data:application/vnd.ms-excel;base64,',
        template = template = '<html 字数限制省略属性><meta http-equiv="Content-Type" charset=utf-8"><head><!--[if gte mso 9]> <head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',
        base64 = function(s) {
            return window.btoa(unescape(encodeURIComponent(s)))
        },
        format = function(s, c) {
            return s.replace(/{(\w+)}/g, function(m, p) {
                return c[p];
            })
        }
    return function(table, name) {
        if (!table.nodeType) table = document.getElementById(table)
        var ctx = {
            worksheet: name || 'Worksheet',
            table: table.innerHTML
        }
        window.location.href = uri + base64(format(template, ctx))
    }
})()
```

- 贴边停靠 <http://www.jq22.com/webqd2141>
- 输入框输入字数限制 <http://www.jq22.com/webqd2084>

- 下拉加载更多 <http://www.jq22.com/webqd2043>

```javascript
$(window).scroll(function() {
    //当时滚动条离底部60px时开始加载下一页的内容
    if (($(window).height() + $(window).scrollTop() + 60) >= $(document).height()) {
        clearTimeout(timers);
        timers = setTimeout(function() {
            page++;
            console.log("第" + page + "页");
            LoadingDataFn();
        }, 300);
    }
});
```

- 固定表头

  - 固定表格列和表格头部内容可拖拽 <http://www.jq22.com/webqd1769>

- 网页标签页消息提示 <http://www.jq22.com/webqd1653>

```javascript
(function(){
    $.extend({
        mengfan:{
            show:function(str){
                var step=0,title=document.title;
                var timer=setInterval(function(){
                    step++;
                    if(step==3){step=1};
                    if(step==1){document.title=title};
                    if(step==2){document.title='【'+str+'】'+title};
                },500);
                return [timer,title];
            },
            clear:function(timerarr){
                if(timerarr){
                clearInterval(timerarr[0]);
                document.title=timerarr[1];
                };

            }
        }
    });
})(jQuery)


message=$.mengfan.show('新消息');
    setTimeout(function(){
        $.mengfan.clear(message);
},10000);
```

- 复制文字追加网站来源

  - <http://www.jq22.com/webqd581>

```javascript
//复制内容自动添加版权信息
var Sys = {};
var ua = navigator.userAgent.toLowerCase();
if( window.ActiveXObject )
{
    document.body.oncopy=function()
    {
        event.returnValue = false;
        var t=document.selection.createRange().text;
        var s="\r\n原文出自[jQuery插件库] 转载请保留原文链接:"+location.href;
        clipboardData.setData('Text',t+'\r\n'+s);
    }
}

else
{
    function addLink()
    {
        var body_element = document.getElementsByTagName('body')[0];
        var selection;
        selection = window.getSelection();
        var pagelink = " 原文出自[jQuery插件库] 转载请保留原文链接:"+document.location.href;

        var copytext = selection + pagelink;
        var newdiv = document.createElement('div');
        newdiv.style.position='absolute';
        newdiv.style.left='-99999px';
        body_element.appendChild(newdiv);
        newdiv.innerHTML = copytext;
        selection.selectAllChildren(newdiv);
        window.setTimeout(function(){
          body_element.removeChild(newdiv);
        }, 0);
    }
    document.oncopy = addLink;
}
```

- 卷轴动画

  - <http://www.jq22.com/webqd790>
